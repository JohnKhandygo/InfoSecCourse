\section{Разбора файлов в составе Nmap}

Проведем теперь разбор некоторых файлов в составе утилиты Nmap. Сначала обратимся к файлу nmap-service-probes и рассмотрим несколько 
записей из него.

\begin{description}
    \item \src{Probe TCP NULL q||} \hfill \\
        Указывает использовать в качестве пробы TCP запрос с пустым телом.
    \item \src{totalwaitms 6000} \hfill \\
        Указывает ожидать ответа в течении $6$ти секунд.
    \item \src{match acmp m|^ACMP Server Version ([\w._-]+)\r\n| p/Aagon ACMP Inventory/ v/$1/} \hfill \\
        Данная запись задает строку сравнения для определения ACMP сервиса. В соответствии с регулярным выражением ACMP сервис 
        распознается если строка ответа начинается с подстроки \src{ACMP Server Version} за которой следует последовательность 
        символов, которая будет распознана как версия.
    \item \src{match AndroMouse m|^AMServer$|s p/AndroMouse Android remote mouse server/}
        Данная запись задает строку сравнения для определения сервиса AndroMouse. В соответствии с регулярным выражением данный сервис 
        распознается если строка ответа в точности соответствует \src{AMServer}.
\end{description}

Проведем теперь разбор какого-либо скрипта из состава Nmap. В качестве примера был выбран скрипт \src{vnc-info.nse}. Его исходный 
код прелставлен в листинге \ref{lst:nse}. Разберем работу этого скрипта:
\begin{itemize}
    \item Строки $1 -- 3$ содержат подключение необходимых библиотек.
    \item В строках $5 -- 11$ содержится некоторая метаинформация о скрипте.
    \item В строках $13$ и $14$ содержится описание необходимых локальных переменных и функций.
    \item В строке $19$ создается объект класса типа \src{VNC}. 
    \item В строке $23$ происходит установка соеденения с выбранным портом по указанному адресу.
    \item Затем в строке $26$ роисходит попытка <<авторизации>> клиента. 
    \item Строки с $26$ой по $42$ую отвечают за формирование результата.
\end{itemize}

\begin{listing}[H]
    \inputminted{console}{resources/18_nse}
    \caption{Текст скрипта \sec{vnc-info.nse}}
    \label{lst:nse}
\end{listing}